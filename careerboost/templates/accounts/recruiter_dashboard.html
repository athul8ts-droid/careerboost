{% extends "base.html" %}

{% block content %}

<h2>Recruiter Dashboard üßë‚Äçüíº</h2>
<p>Post jobs and manage applications.</p>

<!-- Recruiter Approval Status -->
{% if request.user.is_approved %}

    <p style="color: green;">‚úÖ Approved Recruiter</p>

    <a href="{% url 'job_app:add_job' %}" class="btn btn-primary">
        Post New Job
    </a>    
{% else %}
    <p style="color: orange;">‚è≥ Pending Approval</p>

    <button class="btn btn-secondary mb-3" disabled>
        Post New Job 
    </button>

    <p>
        Your account is under admin review. You‚Äôll be notified once approved.
    </p>
{% endif %}

<hr>

<!-- Recruiter Posted Jobs -->
<h3>My Posted Jobs</h3>

{% if jobs %}
    <ul class="list-unstyled">
        {% for job in jobs %}
            <li class="mb-4">
                <strong>{{ job.title }}</strong><br>
                {{ job.location }}<br>
                Posted on {{ job.created_at|date:"d M Y" }}

                <br><br>

                <!-- VIEW APPLICANTS -->
                <a class="btn btn-primary btn-sm"
                   href="{% url 'job_app:view_applicants' job.id %}">
                    View Applicants ({{ job.applications.count }})
                </a>

                <!-- DELETE JOB (POST ONLY ‚úÖ) -->
                <form method="post"
                      action="{% url 'job_app:delete_job' job.id %}"
                      style="display:inline;"
                      onsubmit="return confirm('Are you sure you want to delete this job?');">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger btn-sm">
                        Delete Job
                    </button>
                </form>
            </li>
        {% endfor %}
    </ul>
{% else %}
    <p>You haven‚Äôt posted any jobs yet.</p>
{% endif %}

{% endblock %}
